exports.id = 0;
exports.modules = {

/***/ "./src/backend/socket/Player.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("Object.defineProperty(exports, \"__esModule\", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if (\"value\" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();var _Emitter2 = __webpack_require__(\"./src/backend/socket/Emitter.js\");var _Emitter3 = _interopRequireDefault(_Emitter2);\nvar _models = __webpack_require__(\"./src/backend/models/index.js\");function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== \"function\" && superClass !== null) {throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}var\n\nPlayer = function (_Emitter) {_inherits(Player, _Emitter);\n  function Player(io, game, author) {_classCallCheck(this, Player);var _this = _possibleConstructorReturn(this, (Player.__proto__ || Object.getPrototypeOf(Player)).call(this,\n    io, game.room));\n    _this.game = game;\n    _this.connected = 1;\n\n    _this.user = author;\n    _this.typing = false;\n    _this.bid = null;return _this;\n  }_createClass(Player, [{ key: 'connect', value: function connect()\n\n    {\n      this.connected++;\n      this.game.update();\n    } }, { key: 'disconnect', value: function disconnect()\n\n    {\n      if (--this.connected < 1) {\n        if (!this.game.started_at) {\n          this.game.removePlayer(this);\n        } else if (this.game.isPlaying()) {\n          this.giveUp();\n        }\n      }\n    } }, { key: 'startTyping', value: function startTyping()\n\n    {\n      this.typing = true;\n      this.update();\n    } }, { key: 'stopTyping', value: function stopTyping()\n\n    {\n      this.typing = false;\n      this.update();\n    } }, { key: 'submit', value: function submit(\n\n    code) {var _this2 = this;\n      if (!this.isDone()) {\n        this.submitted_at = new Date();\n        new _models.Bid({\n          auction: this.game.auction,\n          time: (this.submitted_at - this.game.started_at) / 1000,\n          code: code,\n          author: this.user }).\n        force().save().\n        then(function (bid) {\n          _this2.bid = bid.toJSON({ req: {} });\n          if (_this2.game.isEveryoneDone()) return _this2.game.finish();\n          _this2.update();\n        }).\n        catch(console.error);\n      }\n    } }, { key: 'giveUp', value: function giveUp()\n\n    {\n      if (!this.isDone()) {\n        this.given_up_at = new Date();\n        if (this.game.isEveryoneDone()) return this.game.finish();\n        this.update();\n      }\n    } }, { key: 'isDone', value: function isDone()\n\n    {\n      return this.submitted_at || this.given_up_at;\n    } }, { key: 'update', value: function update()\n\n    {\n      this.updated_at = new Date();\n      this.emit('PLAYER_UPDATED', this);\n    } }, { key: 'rate', value: function rate(\n\n    bid_id, stars) {var _this3 = this;\n      _models.Bid.get(bid_id).\n      then(function (bid) {return bid.rate(stars, _this3.user);}).\n      then(function (bid) {\n        var ratedPlayer = _this3.game.players.find(function (player) {return player.bid && player.bid._id.equals(bid_id);});\n        ratedPlayer.average_stars = bid.average_stars;\n        ratedPlayer.ratings[_this3.user.username] = stars;\n        _this3.game.players = _this3.game.players.sort(function (p1, p2) {return (p2.average_stars || 0) - (p1.average_stars || 0);});\n        _this3.game.update();\n      }).\n      catch(console.error);\n    } }, { key: 'toJSON', value: function toJSON()\n\n    {var\n\n      user =\n\n\n\n\n\n\n      this.user,submitted_at = this.submitted_at,given_up_at = this.given_up_at,typing = this.typing,bid = this.bid,ratings = this.ratings,average_stars = this.average_stars;\n      return {\n        user: user,\n        submitted_at: submitted_at,\n        given_up_at: given_up_at,\n        typing: typing,\n        bid: bid,\n        ratings: ratings,\n        average_stars: average_stars };\n\n    } }]);return Player;}(_Emitter3.default);exports.default =\n\n\nPlayer;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFja2VuZC9zb2NrZXQvUGxheWVyLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2JhY2tlbmQvc29ja2V0L1BsYXllci5qcz9jZGM0Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHtmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7dmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7ZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO2lmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO319cmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO2lmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO3JldHVybiBDb25zdHJ1Y3Rvcjt9O30oKTt2YXIgX0VtaXR0ZXIyID0gcmVxdWlyZSgnLi9FbWl0dGVyJyk7dmFyIF9FbWl0dGVyMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0VtaXR0ZXIyKTtcbnZhciBfbW9kZWxzID0gcmVxdWlyZSgnL21vZGVscycpO2Z1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7cmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07fWZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge3Rocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7fX1mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7aWYgKCFzZWxmKSB7dGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO31yZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjt9ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7aWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkge3Rocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpO31zdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pO2lmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczt9dmFyXG5cblBsYXllciA9IGZ1bmN0aW9uIChfRW1pdHRlcikge19pbmhlcml0cyhQbGF5ZXIsIF9FbWl0dGVyKTtcbiAgZnVuY3Rpb24gUGxheWVyKGlvLCBnYW1lLCBhdXRob3IpIHtfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGxheWVyKTt2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoUGxheWVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUGxheWVyKSkuY2FsbCh0aGlzLFxuICAgIGlvLCBnYW1lLnJvb20pKTtcbiAgICBfdGhpcy5nYW1lID0gZ2FtZTtcbiAgICBfdGhpcy5jb25uZWN0ZWQgPSAxO1xuXG4gICAgX3RoaXMudXNlciA9IGF1dGhvcjtcbiAgICBfdGhpcy50eXBpbmcgPSBmYWxzZTtcbiAgICBfdGhpcy5iaWQgPSBudWxsO3JldHVybiBfdGhpcztcbiAgfV9jcmVhdGVDbGFzcyhQbGF5ZXIsIFt7IGtleTogJ2Nvbm5lY3QnLCB2YWx1ZTogZnVuY3Rpb24gY29ubmVjdCgpXG5cbiAgICB7XG4gICAgICB0aGlzLmNvbm5lY3RlZCsrO1xuICAgICAgdGhpcy5nYW1lLnVwZGF0ZSgpO1xuICAgIH0gfSwgeyBrZXk6ICdkaXNjb25uZWN0JywgdmFsdWU6IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKVxuXG4gICAge1xuICAgICAgaWYgKC0tdGhpcy5jb25uZWN0ZWQgPCAxKSB7XG4gICAgICAgIGlmICghdGhpcy5nYW1lLnN0YXJ0ZWRfYXQpIHtcbiAgICAgICAgICB0aGlzLmdhbWUucmVtb3ZlUGxheWVyKHRoaXMpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ2FtZS5pc1BsYXlpbmcoKSkge1xuICAgICAgICAgIHRoaXMuZ2l2ZVVwKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IH0sIHsga2V5OiAnc3RhcnRUeXBpbmcnLCB2YWx1ZTogZnVuY3Rpb24gc3RhcnRUeXBpbmcoKVxuXG4gICAge1xuICAgICAgdGhpcy50eXBpbmcgPSB0cnVlO1xuICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9IH0sIHsga2V5OiAnc3RvcFR5cGluZycsIHZhbHVlOiBmdW5jdGlvbiBzdG9wVHlwaW5nKClcblxuICAgIHtcbiAgICAgIHRoaXMudHlwaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH0gfSwgeyBrZXk6ICdzdWJtaXQnLCB2YWx1ZTogZnVuY3Rpb24gc3VibWl0KFxuXG4gICAgY29kZSkge3ZhciBfdGhpczIgPSB0aGlzO1xuICAgICAgaWYgKCF0aGlzLmlzRG9uZSgpKSB7XG4gICAgICAgIHRoaXMuc3VibWl0dGVkX2F0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgbmV3IF9tb2RlbHMuQmlkKHtcbiAgICAgICAgICBhdWN0aW9uOiB0aGlzLmdhbWUuYXVjdGlvbixcbiAgICAgICAgICB0aW1lOiAodGhpcy5zdWJtaXR0ZWRfYXQgLSB0aGlzLmdhbWUuc3RhcnRlZF9hdCkgLyAxMDAwLFxuICAgICAgICAgIGNvZGU6IGNvZGUsXG4gICAgICAgICAgYXV0aG9yOiB0aGlzLnVzZXIgfSkuXG4gICAgICAgIGZvcmNlKCkuc2F2ZSgpLlxuICAgICAgICB0aGVuKGZ1bmN0aW9uIChiaWQpIHtcbiAgICAgICAgICBfdGhpczIuYmlkID0gYmlkLnRvSlNPTih7IHJlcToge30gfSk7XG4gICAgICAgICAgaWYgKF90aGlzMi5nYW1lLmlzRXZlcnlvbmVEb25lKCkpIHJldHVybiBfdGhpczIuZ2FtZS5maW5pc2goKTtcbiAgICAgICAgICBfdGhpczIudXBkYXRlKCk7XG4gICAgICAgIH0pLlxuICAgICAgICBjYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICAgIH1cbiAgICB9IH0sIHsga2V5OiAnZ2l2ZVVwJywgdmFsdWU6IGZ1bmN0aW9uIGdpdmVVcCgpXG5cbiAgICB7XG4gICAgICBpZiAoIXRoaXMuaXNEb25lKCkpIHtcbiAgICAgICAgdGhpcy5naXZlbl91cF9hdCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGlmICh0aGlzLmdhbWUuaXNFdmVyeW9uZURvbmUoKSkgcmV0dXJuIHRoaXMuZ2FtZS5maW5pc2goKTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgIH1cbiAgICB9IH0sIHsga2V5OiAnaXNEb25lJywgdmFsdWU6IGZ1bmN0aW9uIGlzRG9uZSgpXG5cbiAgICB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJtaXR0ZWRfYXQgfHwgdGhpcy5naXZlbl91cF9hdDtcbiAgICB9IH0sIHsga2V5OiAndXBkYXRlJywgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZSgpXG5cbiAgICB7XG4gICAgICB0aGlzLnVwZGF0ZWRfYXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgdGhpcy5lbWl0KCdQTEFZRVJfVVBEQVRFRCcsIHRoaXMpO1xuICAgIH0gfSwgeyBrZXk6ICdyYXRlJywgdmFsdWU6IGZ1bmN0aW9uIHJhdGUoXG5cbiAgICBiaWRfaWQsIHN0YXJzKSB7dmFyIF90aGlzMyA9IHRoaXM7XG4gICAgICBfbW9kZWxzLkJpZC5nZXQoYmlkX2lkKS5cbiAgICAgIHRoZW4oZnVuY3Rpb24gKGJpZCkge3JldHVybiBiaWQucmF0ZShzdGFycywgX3RoaXMzLnVzZXIpO30pLlxuICAgICAgdGhlbihmdW5jdGlvbiAoYmlkKSB7XG4gICAgICAgIHZhciByYXRlZFBsYXllciA9IF90aGlzMy5nYW1lLnBsYXllcnMuZmluZChmdW5jdGlvbiAocGxheWVyKSB7cmV0dXJuIHBsYXllci5iaWQgJiYgcGxheWVyLmJpZC5faWQuZXF1YWxzKGJpZF9pZCk7fSk7XG4gICAgICAgIHJhdGVkUGxheWVyLmF2ZXJhZ2Vfc3RhcnMgPSBiaWQuYXZlcmFnZV9zdGFycztcbiAgICAgICAgcmF0ZWRQbGF5ZXIucmF0aW5nc1tfdGhpczMudXNlci51c2VybmFtZV0gPSBzdGFycztcbiAgICAgICAgX3RoaXMzLmdhbWUucGxheWVycyA9IF90aGlzMy5nYW1lLnBsYXllcnMuc29ydChmdW5jdGlvbiAocDEsIHAyKSB7cmV0dXJuIChwMi5hdmVyYWdlX3N0YXJzIHx8IDApIC0gKHAxLmF2ZXJhZ2Vfc3RhcnMgfHwgMCk7fSk7XG4gICAgICAgIF90aGlzMy5nYW1lLnVwZGF0ZSgpO1xuICAgICAgfSkuXG4gICAgICBjYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICB9IH0sIHsga2V5OiAndG9KU09OJywgdmFsdWU6IGZ1bmN0aW9uIHRvSlNPTigpXG5cbiAgICB7dmFyXG5cbiAgICAgIHVzZXIgPVxuXG5cblxuXG5cblxuICAgICAgdGhpcy51c2VyLHN1Ym1pdHRlZF9hdCA9IHRoaXMuc3VibWl0dGVkX2F0LGdpdmVuX3VwX2F0ID0gdGhpcy5naXZlbl91cF9hdCx0eXBpbmcgPSB0aGlzLnR5cGluZyxiaWQgPSB0aGlzLmJpZCxyYXRpbmdzID0gdGhpcy5yYXRpbmdzLGF2ZXJhZ2Vfc3RhcnMgPSB0aGlzLmF2ZXJhZ2Vfc3RhcnM7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB1c2VyLFxuICAgICAgICBzdWJtaXR0ZWRfYXQ6IHN1Ym1pdHRlZF9hdCxcbiAgICAgICAgZ2l2ZW5fdXBfYXQ6IGdpdmVuX3VwX2F0LFxuICAgICAgICB0eXBpbmc6IHR5cGluZyxcbiAgICAgICAgYmlkOiBiaWQsXG4gICAgICAgIHJhdGluZ3M6IHJhdGluZ3MsXG4gICAgICAgIGF2ZXJhZ2Vfc3RhcnM6IGF2ZXJhZ2Vfc3RhcnMgfTtcblxuICAgIH0gfV0pO3JldHVybiBQbGF5ZXI7fShfRW1pdHRlcjMuZGVmYXVsdCk7ZXhwb3J0cy5kZWZhdWx0ID1cblxuXG5QbGF5ZXI7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvYmFja2VuZC9zb2NrZXQvUGxheWVyLmpzXG4vLyBtb2R1bGUgaWQgPSAuL3NyYy9iYWNrZW5kL3NvY2tldC9QbGF5ZXIuanNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/backend/socket/Player.js\n");

/***/ })

};