exports.id = 0;
exports.modules = {

/***/ "./src/backend/socket/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("Object.defineProperty(exports, \"__esModule\", { value: true });var _socket = __webpack_require__(\"socket.io\");var _socket2 = _interopRequireDefault(_socket);\nvar _models = __webpack_require__(\"./src/backend/models/index.js\");\nvar _Game = __webpack_require__(\"./src/backend/socket/Game.js\");var _Game2 = _interopRequireDefault(_Game);\nvar _Player = __webpack_require__(\"./src/backend/socket/Player.js\");var _Player2 = _interopRequireDefault(_Player);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}\n\nvar connectSocket = function connectSocket(httpServer) {\n  var io = (0, _socket2.default)(httpServer, { path: '/socket' });\n  var games = [];\n  io.on('connection', function (socket) {\n    socket.on('AUTH', function (data) {var\n      token = data.token,auction_id = data.auction_id;\n      _models.Auth.verify(token).\n      then(function (auth) {return _models.Auth.populate(auth, 'user');}).\n      then(function (auth) {return auth.refresh();}).\n      then(function (auth) {\n        var author = auth.user.toJSON({ req: {} });\n        var game = games.find(function (game) {return game.auction;});\n        if (!game) {\n          game = new _Game2.default(io, function () {\n            var index = games.indexOf(undefined);\n            if (~index) games.splice(index, 1);\n          });\n          games.push(game);\n        }\n        socket.join(game.room);\n\n        var player = game.findPlayer(author);\n        if (player) {\n          player.connect();\n        } else {\n          player = new _Player2.default(io, game, author);\n          game.addPlayer(player);\n        }\n\n        listenOnPlayer(player);\n      }).\n      catch(function (err) {\n        console.error(err);\n        socket.disconnect();\n      });\n    });\n\n    var listenOnPlayer = function listenOnPlayer(player) {\n      socket.on('disconnect', function () {\n        player.disconnect();\n      });\n      socket.on('START_TYPING', function () {\n        player.startTyping();\n      });\n      socket.on('STOP_TYPING', function () {\n        player.stopTyping();\n      });\n      socket.on('SUBMIT', function (code) {\n        player.submit(code);\n      });\n    };\n  });\n};exports.default =\n\nconnectSocket;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFja2VuZC9zb2NrZXQvaW5kZXguanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYmFja2VuZC9zb2NrZXQvaW5kZXguanM/NDc2ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO3ZhciBfc29ja2V0ID0gcmVxdWlyZSgnc29ja2V0LmlvJyk7dmFyIF9zb2NrZXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc29ja2V0KTtcbnZhciBfbW9kZWxzID0gcmVxdWlyZSgnL21vZGVscycpO1xudmFyIF9HYW1lID0gcmVxdWlyZSgnLi9HYW1lJyk7dmFyIF9HYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0dhbWUpO1xudmFyIF9QbGF5ZXIgPSByZXF1aXJlKCcuL1BsYXllcicpO3ZhciBfUGxheWVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1BsYXllcik7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHtyZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTt9XG5cbnZhciBjb25uZWN0U29ja2V0ID0gZnVuY3Rpb24gY29ubmVjdFNvY2tldChodHRwU2VydmVyKSB7XG4gIHZhciBpbyA9ICgwLCBfc29ja2V0Mi5kZWZhdWx0KShodHRwU2VydmVyLCB7IHBhdGg6ICcvc29ja2V0JyB9KTtcbiAgdmFyIGdhbWVzID0gW107XG4gIGlvLm9uKCdjb25uZWN0aW9uJywgZnVuY3Rpb24gKHNvY2tldCkge1xuICAgIHNvY2tldC5vbignQVVUSCcsIGZ1bmN0aW9uIChkYXRhKSB7dmFyXG4gICAgICB0b2tlbiA9IGRhdGEudG9rZW4sYXVjdGlvbl9pZCA9IGRhdGEuYXVjdGlvbl9pZDtcbiAgICAgIF9tb2RlbHMuQXV0aC52ZXJpZnkodG9rZW4pLlxuICAgICAgdGhlbihmdW5jdGlvbiAoYXV0aCkge3JldHVybiBfbW9kZWxzLkF1dGgucG9wdWxhdGUoYXV0aCwgJ3VzZXInKTt9KS5cbiAgICAgIHRoZW4oZnVuY3Rpb24gKGF1dGgpIHtyZXR1cm4gYXV0aC5yZWZyZXNoKCk7fSkuXG4gICAgICB0aGVuKGZ1bmN0aW9uIChhdXRoKSB7XG4gICAgICAgIHZhciBhdXRob3IgPSBhdXRoLnVzZXIudG9KU09OKHsgcmVxOiB7fSB9KTtcbiAgICAgICAgdmFyIGdhbWUgPSBnYW1lcy5maW5kKGZ1bmN0aW9uIChnYW1lKSB7cmV0dXJuIGdhbWUuYXVjdGlvbjt9KTtcbiAgICAgICAgaWYgKCFnYW1lKSB7XG4gICAgICAgICAgZ2FtZSA9IG5ldyBfR2FtZTIuZGVmYXVsdChpbywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gZ2FtZXMuaW5kZXhPZih1bmRlZmluZWQpO1xuICAgICAgICAgICAgaWYgKH5pbmRleCkgZ2FtZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBnYW1lcy5wdXNoKGdhbWUpO1xuICAgICAgICB9XG4gICAgICAgIHNvY2tldC5qb2luKGdhbWUucm9vbSk7XG5cbiAgICAgICAgdmFyIHBsYXllciA9IGdhbWUuZmluZFBsYXllcihhdXRob3IpO1xuICAgICAgICBpZiAocGxheWVyKSB7XG4gICAgICAgICAgcGxheWVyLmNvbm5lY3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwbGF5ZXIgPSBuZXcgX1BsYXllcjIuZGVmYXVsdChpbywgZ2FtZSwgYXV0aG9yKTtcbiAgICAgICAgICBnYW1lLmFkZFBsYXllcihwbGF5ZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdGVuT25QbGF5ZXIocGxheWVyKTtcbiAgICAgIH0pLlxuICAgICAgY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIHNvY2tldC5kaXNjb25uZWN0KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHZhciBsaXN0ZW5PblBsYXllciA9IGZ1bmN0aW9uIGxpc3Rlbk9uUGxheWVyKHBsYXllcikge1xuICAgICAgc29ja2V0Lm9uKCdkaXNjb25uZWN0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICBwbGF5ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgfSk7XG4gICAgICBzb2NrZXQub24oJ1NUQVJUX1RZUElORycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcGxheWVyLnN0YXJ0VHlwaW5nKCk7XG4gICAgICB9KTtcbiAgICAgIHNvY2tldC5vbignU1RPUF9UWVBJTkcnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHBsYXllci5zdG9wVHlwaW5nKCk7XG4gICAgICB9KTtcbiAgICAgIHNvY2tldC5vbignU1VCTUlUJywgZnVuY3Rpb24gKGNvZGUpIHtcbiAgICAgICAgcGxheWVyLnN1Ym1pdChjb2RlKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xufTtleHBvcnRzLmRlZmF1bHQgPVxuXG5jb25uZWN0U29ja2V0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2JhY2tlbmQvc29ja2V0L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAuL3NyYy9iYWNrZW5kL3NvY2tldC9pbmRleC5qc1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/backend/socket/index.js\n");

/***/ })

};